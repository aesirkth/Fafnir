/dts-v1/;
#include <st/u5/stm32u575Xg.dtsi>
#include <st/u5/stm32u575rgtx-pinctrl.dtsi>
#include <zephyr/dt-bindings/input/input-event-codes.h>

/ {
	model = "Fafnir board";

	chosen {
		zephyr,sram = &sram0;
		zephyr,flash = &flash0;
		zephyr,canbus = &fdcan1;
	};

    // aliases {
	// 	led0 = &led0;
	// };

    leds {
        compatible = "gpio-leds";
        
        led0: led_0 {
			gpios = <&gpiob 6 GPIO_ACTIVE_HIGH>;
			label = "Green LED 0";
		};
    };

    pwmleds: pwmleds {
		compatible = "pwm-leds";
		status = "okay";

		motor: motor {
			pwms = <&pwm3 1 PWM_MSEC(20) PWM_POLARITY_NORMAL>;
		};
	};

};

&timers3 {
    st,prescaler = <900>;
	status = "okay";

	pwm3: pwm {
		status = "okay";
		pinctrl-0 = <&tim3_ch1_pa6>;
		pinctrl-names = "default";
	};
};

&clk_hse {
    clock-frequency = <DT_FREQ_M(24)>; /* your crystal MHz */
    status = "okay";
};

&pll1 {
	div-m = <2>;
	mul-n = <30>;
	div-q = <4>;
	div-r = <4>;
	clocks = <&clk_hse>;
	status = "okay";
};

&rcc {
	clocks = <&pll1>;
	clock-frequency = <DT_FREQ_M(90)>;
	ahb-prescaler = <1>;
	apb1-prescaler = <1>;
	apb2-prescaler = <1>;
	apb3-prescaler = <1>;
};

// &fdcan1 {
// 	clocks = <&rcc STM32_CLOCK_BUS_APB1_2 0x00000200>,
// 		 <&rcc STM32_SRC_PLL1_Q FDCAN1_SEL(1)>;
// 	pinctrl-0 = <&fdcan1_rx_pb8 &fdcan1_tx_pb9>;
// 	pinctrl-names = "default";
// 	status = "okay";
// };

